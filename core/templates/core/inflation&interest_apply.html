{% extends "base.html" %}
{% load static %}


{% block css_files %}
{% endblock css_files %}

{% block page_title %}اعمال سود بانک و تورم{% endblock page_title %}

{% block page_content %}

<div class="container text-center">
 <div class="container col-md-5">

  <!-- Messages Section -->
  <div class="message-container mb-3" style="min-height: 60px;">
    {% if messages %}
        {% for message in messages %}
            <div class="alert {{ message.tags }} text-center" role="alert">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
  </div>

<div class="text-center mt-3">

  <div class="mb-3">
      {% if not inflation_done %}
        <form method="POST" action="{% url 'core:apply_inflation' %}" class="d-inline">
          {% csrf_token %}
          <button type="submit" class="btn btn-danger mx-2">اعمال تورم {{current_round}}</button>
        </form>
      {% else %}
          <button class="btn btn-dark mx-2">پایان تورم‌ها</button>
      {% endif %}
      <form method="POST" action="{% url 'core:reset_inflation' %}" class="d-inline">
        {% csrf_token %}
        <button type="submit" class="btn btn-primary mx-2">ریست قیمت‌ها</button>
      </form>
    </div>

    <div class="mb-3">
      <form method="POST" action="{% url 'core:apply_interest' %}" class="d-inline">
        {% csrf_token %}
        <button type="submit" class="btn btn-info mx-2">اعمال سود بانک  {{interest_rate}} درصد</button>
      </form>
    </div>

  <div class='mt-3'>
    <a href="{% url 'core:home' %}" class="btn btn-secondary btn-lg">بازگشت</a>
  </div>

</div>

{% endblock page_content %}


{% block page_scripts %}
<script>


document.addEventListener('DOMContentLoaded', function() {

      // Fading alerts
      const alerts = document.querySelectorAll('.alert:not(.alert-success)');

      alerts.forEach(alert => {
        setTimeout(() => {
          alert.style.transition = "opacity 1s";
          alert.style.opacity = "0";

          setTimeout(() => {
            alert.remove();
          }, 1000);
        }, 3000);
      });


      // If the operation was successful, the page reloads after 2 seconds
      const successAlert = document.querySelector('.alert-success');
      if (successAlert) {
          setTimeout(() => {
            window.location.reload();
          }, 2700);
      }
  });

</script>
{% endblock page_scripts %}
