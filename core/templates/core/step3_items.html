{% extends "base.html" %}
{% load static %}

{% block css_files %}
<link rel="stylesheet" href="{% static "core/step2_questions.css" %}">
{% endblock css_files %}

{% block page_title %}صفحه سوم{% endblock page_title %}

{% block page_content %}
<div class="container text-center mt-5 col-md-10">
  <h2 class="mb-4">تنظیم کالاها</h2>

  <form method="POST" id="items-form" dir="rtl">
    {% csrf_token %}

    <!-- تعداد کالاها -->
    <div class="mb-3 text-end">
      <label>تعداد کالاها:</label>
      <input type="number" id="count" name="count" class="form-control w-25 d-inline-block" min="1" required>
    </div>

    <!-- محل قرارگیری باکس‌ها -->
    <div id="items-container" class="row g-3 justify-content-start text-end"></div>

    <div class="mt-3 mb-5">
      <button type="submit" class="btn btn-primary btn-lg mx-2">مرحله بعد</button>
      <a href="{% url 'core:setup_step2' %}" class="btn btn-info btn-lg mx-2">مرحله قبل</a>
    </div>
  </form>
</div>

<script>
document.getElementById('count').addEventListener('input', function() {
  const container = document.getElementById('items-container');
  container.innerHTML = ''; // پاک کردن باکس‌های قبلی
  const count = parseInt(this.value) || 0;

  for (let i = 1; i <= count; i++) {
    // هر کارت در یک col-12 روی موبایل، و col-md-4 (یعنی ۳ تا در هر ردیف) روی دسکتاپ
    const col = document.createElement('div');
    col.className = 'col-12 col-md-4';

    col.innerHTML = `
      <div class="card h-100 shadow-sm">
        <div class="card-body text-end">
          <h5 class="card-title mb-3">کالا ${i}</h5>
          <div class="mb-2">
            <label>نام کالا:</label>
            <input type="text" name="name_${i}" class="form-control" required>
          </div>
          <div class="mb-2">
            <label>قیمت پایه:</label>
            <input type="number" name="price_${i}" class="form-control" required>
          </div>
        </div>
      </div>
    `;

    container.appendChild(col);
  }
});
</script>
{% endblock %}
